"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[4350],{"4350":function(A){A.exports=JSON.parse('{"version":3,"names":["indexCss","easeOutScroll","from","to","duration","callback","change","sTime","Date","now","isLarger","linear","t","b","c","d","step","requestAnimationFrame","ScrollView","this","_scrollLeft","_scrollTop","upperAndLower","debounce","_b","_this","el","offsetWidth","offsetHeight","scrollLeft","scrollTop","scrollHeight","scrollWidth","lowerThreshold","Number","upperThreshold","isNaN","scrollY","scrollX","onScrollToLower","emit","direction","onScrollToUpper","class_1","prototype","watchScrollLeft","newVal","left","animated","mpScrollToMethod","watchScrollTop","top","watchScrollIntoView","mpScrollIntoViewMethod","handleScroll","e","CustomEvent","stopPropagation","onScroll","object","pos","selector","_a","document","querySelector","concat","scrollIntoView","behavior","block","inline","componentDidLoad","mpScrollTop","mpScrollLeft","render","cls","classNames","h","Host","class"],"sources":["src/components/scroll-view/style/index.scss?tag=taro-scroll-view-core","src/components/scroll-view/scroll-view.tsx"],"sourcesContent":["taro-scroll-view-core {\\n  display: block;\\n  width: 100%;\\n  -webkit-overflow-scrolling: auto;\\n\\n  &::-webkit-scrollbar {\\n    display: none;\\n  }\\n}\\n\\n.taro-scroll-view {\\n  &__scroll-x {\\n    overflow-x: scroll;\\n    overflow-y: hidden;\\n  }\\n\\n  &__scroll-y {\\n    overflow-x: hidden;\\n    overflow-y: scroll;\\n  }\\n}\\n","import { Component, h, ComponentInterface, Prop, Event, EventEmitter, Watch, Element, Method, Host, Listen } from \'@stencil/core\'\\nimport classNames from \'classnames\'\\n\\nimport { debounce } from \'../../utils\'\\n\\nimport type { ScrollViewContext } from \'@tarojs/taro\'\\n\\nfunction easeOutScroll (from: number, to: number, duration = 500, callback?) {\\n  if (from === to || typeof from !== \'number\') {\\n    return\\n  }\\n\\n  const change = to - from\\n  const sTime = Date.now()\\n  const isLarger = to >= from\\n\\n  function linear (t: number, b: number, c: number, d: number): number {\\n    return c * t / d + b\\n  }\\n\\n  function step () {\\n    from = linear(Date.now() - sTime, from, change, duration)\\n    if ((isLarger && from >= to) || (!isLarger && to >= from)) {\\n      callback(to)\\n      return\\n    }\\n    callback(from)\\n    requestAnimationFrame(step)\\n  }\\n\\n  step()\\n}\\n\\n@Component({\\n  tag: \'taro-scroll-view-core\',\\n  styleUrl: \'./style/index.scss\'\\n})\\nexport class ScrollView implements ComponentInterface {\\n  private _scrollLeft = 0\\n  private _scrollTop = 0\\n\\n  @Element() el: HTMLElement\\n\\n  @Prop() scrollX = false\\n  @Prop() scrollY = false\\n  @Prop() upperThreshold: number | string = 50\\n  @Prop() lowerThreshold: number | string = 50\\n  @Prop({ attribute: \'scroll-top\', reflect: true }) mpScrollTop: number | string\\n  @Prop({ attribute: \'scroll-left\', reflect: true }) mpScrollLeft: number | string\\n  @Prop({ attribute: \'scroll-into-view\', reflect: true }) mpScrollIntoView: string\\n  @Prop({ attribute: \'scroll-with-animation\' }) animated = false\\n\\n  @Event({\\n    eventName: \'scroll\',\\n    bubbles: false\\n  })\\n  onScroll: EventEmitter\\n\\n  @Event({\\n    eventName: \'scrolltoupper\',\\n    bubbles: false\\n  })\\n  onScrollToUpper: EventEmitter\\n\\n  @Event({\\n    eventName: \'scrolltolower\',\\n    bubbles: false\\n  })\\n  onScrollToLower: EventEmitter\\n\\n  @Watch(\'mpScrollLeft\')\\n  watchScrollLeft (newVal) {\\n    const left = Number(newVal)\\n    const { animated } = this\\n\\n    this.mpScrollToMethod({\\n      left, animated\\n    })\\n  }\\n\\n  @Watch(\'mpScrollTop\')\\n  watchScrollTop (newVal) {\\n    const top = Number(newVal)\\n    const { animated } = this\\n\\n    this.mpScrollToMethod({\\n      top, animated\\n    })\\n  }\\n\\n  @Watch(\'mpScrollIntoView\')\\n  watchScrollIntoView (newVal) {\\n    this.mpScrollIntoViewMethod(newVal)\\n  }\\n\\n  @Listen(\'scroll\', { capture: true })\\n  handleScroll (e: Event) {\\n    if (e instanceof CustomEvent) return\\n    e.stopPropagation()\\n\\n    const {\\n      scrollLeft,\\n      scrollTop,\\n      scrollHeight,\\n      scrollWidth\\n    } = this.el\\n    this._scrollLeft = scrollLeft\\n    this._scrollTop = scrollTop\\n\\n    this.upperAndLower()\\n\\n    this.onScroll.emit({\\n      scrollLeft,\\n      scrollTop,\\n      scrollHeight,\\n      scrollWidth\\n    })\\n  }\\n\\n  @Method()\\n  async mpScrollToMethod(object: ScrollViewContext.scrollTo.Option) {\\n    let { top, left, duration, animated = false } = object\\n\\n    if (this.scrollY && typeof top === \'number\' && !isNaN(top) && top !== this._scrollTop) {\\n      if (animated) {\\n        easeOutScroll(this._scrollTop, top, duration, pos => (this.el.scrollTop = pos))\\n      } else {\\n        this.el.scrollTop = top\\n      }\\n      this._scrollTop = top\\n    }\\n\\n    if (this.scrollX && typeof left === \'number\' && !isNaN(left) && left !== this._scrollLeft) {\\n      if (animated) {\\n        easeOutScroll(this._scrollLeft, left, duration, pos => (this.el.scrollLeft = pos))\\n      } else {\\n        this.el.scrollLeft = left\\n      }\\n      this._scrollLeft = left\\n    }\\n  }\\n\\n  @Method()\\n  async mpScrollIntoViewMethod(selector: string) {\\n    if (typeof selector === \'string\' && selector) {\\n      document.querySelector(`#${selector}`)?.scrollIntoView({\\n        behavior: \'smooth\',\\n        block: \'center\',\\n        inline: \'start\'\\n      })\\n    }\\n  }\\n\\n  componentDidLoad () {\\n    const top = Number(this.mpScrollTop)\\n    const left = Number(this.mpScrollLeft)\\n    const { animated } = this\\n\\n    this.mpScrollToMethod({\\n      top, left, animated\\n    })\\n  }\\n\\n  upperAndLower = debounce(() => {\\n    const {\\n      offsetWidth,\\n      offsetHeight,\\n      scrollLeft,\\n      scrollTop,\\n      scrollHeight,\\n      scrollWidth\\n    } = this.el\\n\\n    const lowerThreshold = Number(this.lowerThreshold)\\n    const upperThreshold = Number(this.upperThreshold)\\n\\n    if (\\n      !isNaN(lowerThreshold) &&\\n      ((this.scrollY && offsetHeight + scrollTop + lowerThreshold >= scrollHeight) ||\\n      (this.scrollX && offsetWidth + scrollLeft + lowerThreshold >= scrollWidth))\\n    ) {\\n      this.onScrollToLower.emit({\\n        direction: this.scrollX ? \'right\' : (this.scrollY ? \'bottom\' : \'\')\\n      })\\n    }\\n\\n    if (\\n      !isNaN(upperThreshold) &&\\n      ((this.scrollY && scrollTop <= upperThreshold) ||\\n      (this.scrollX && scrollLeft <= upperThreshold))\\n    ) {\\n      this.onScrollToUpper.emit({\\n        direction: this.scrollX ? \'left\' : (this.scrollY ? \'top\' : \'\')\\n      })\\n    }\\n  }, 200)\\n\\n  render () {\\n    const { scrollX, scrollY } = this\\n\\n    const cls = classNames({\\n      \'taro-scroll-view__scroll-x\': scrollX,\\n      \'taro-scroll-view__scroll-y\': scrollY\\n    })\\n    return (\\n      <Host class={cls}>\\n        <slot />\\n      </Host>\\n    )\\n  }\\n}\\n"],"mappings":"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"}')}}]);